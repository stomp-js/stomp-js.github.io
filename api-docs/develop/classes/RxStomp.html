<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>stompjs@7.0.0-beta1, rx-stomp@2.0.0-beta1</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
        <link rel="stylesheet" href="../styles/postmark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">stompjs@7.0.0-beta1, rx-stomp@2.0.0-beta1</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Classes</li>
  <li >RxStomp</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>consolidated/rx-stomp/src/rx-stomp.ts</code>
        </p>


            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>This is the main Stomp Client.
Typically you will create an instance of this to connect to the STOMP broker.</p>
<p>This wraps <a href="https://github.com/stomp-js/stompjs">@stomp/stompjs</a>
<a href="../classes/Client.html">Client</a> class.</p>
<p>The key difference is that it exposes operations as RxJS Observables.
For example when a STOMP endpoint is subscribed it returns an Observable
that will stream all received messages.</p>
<p>With exception of beforeConnect, functionality related to all callbacks in
<a href="../classes/Client.html">@stomp/stompjs Client</a>
is exposed as Observables/Subjects/BehaviorSubjects.</p>
<p>RxStomp also tries to transparently handle connection failures.</p>
<p>Part of <code>@stomp/rx-stomp</code></p>

            </p>




            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#connected$" >connected$</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#connectionState$" >connectionState$</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#serverHeaders$" >serverHeaders$</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#stompErrors$" >stompErrors$</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#unhandledFrame$" >unhandledFrame$</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#unhandledMessage$" >unhandledMessage$</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#unhandledReceipts$" >unhandledReceipts$</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#webSocketErrors$" >webSocketErrors$</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#activate" >activate</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#configure" >configure</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#connected" >connected</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#deactivate" >deactivate</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#publish" >publish</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#watch" >watch</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#watch" >watch</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#watch" >watch</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#watchForReceipt" >watchForReceipt</a>
                            </li>
                        </ul>
                    </td>
                </tr>





                    <tr>
                        <td class="col-md-4">
                            <h6><b>Accessors</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                    <a href="#stompClient" >stompClient</a>
                                </li>
                                <li>
                                    <a href="#active" >active</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                                <span class="modifier">Public</span>
                        <code>constructor(stompClient?: <a href="../classess/Client.html" target="_self">Client</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="174" class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:174</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>Constructor</p>
<p><a href="https://github.com/stomp-js/stompjs">@stomp/stompjs</a>
<a href="../classes/Client.html">Client</a> to wrap. If this is not provided, a client will
be constructed internally.</p>
</div>
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                                    <td>Description</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>stompClient</td>
                                                  
                                                        <td>
                                                                        <code><a href="../classess/Client.html" target="_self" >Client</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            Yes
                                                    </td>
                                                    
                                                        <td>
                                                                <p>optionally inject the
[@stomp/stompjs]://github.com/stomp-js/stompjs<a href="https">https</a>
<a href="../classes/Client.html">Client</a> to wrap. If this is not provided, a client will
be constructed internally.</p>

                                                        </td>
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="connected$"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>connected$</b></span>
                        <a href="#connected$"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>Observable&lt;RxStompState&gt;</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="62" class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:62</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Will trigger when connection is established.
It will trigger every time a (re)connection occurs.
If it is already connected it will trigger immediately.
You can safely ignore the value, as it will always be <code>StompState.OPEN</code></p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="connectionState$"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>connectionState$</b></span>
                        <a href="#connectionState$"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>BehaviorSubject&lt;RxStompState&gt;</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="54" class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:54</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Connection State</p>
<p>It is a BehaviorSubject and will emit current status immediately. This will typically get
used to show current status to the end user.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="serverHeaders$"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>serverHeaders$</b></span>
                        <a href="#serverHeaders$"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>Observable&lt;StompHeaders&gt;</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="77" class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:77</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Provides headers from most recent connection to the server as returned by the CONNECTED frame.
If the STOMP connection has already been established it will trigger immediately.
It will trigger for each reconnection.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="stompErrors$"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>stompErrors$</b></span>
                        <a href="#stompErrors$"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../interfaces/IFrame.html" target="_self" >Subject&lt;IFrame&gt;</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="132" class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:132</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>It will stream all ERROR frames received from the STOMP Broker.
A compliant STOMP Broker will close the connection after this type of frame.
Please check broker specific documentation for exact behavior.</p>
<p>This Observer will yield the received
<a href="../interfaces/IFrame.html">IFrame</a>
objects.</p>
<p>Maps to: <a href="../classes/Client.html#onStompError">Client#onStompError</a></p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="unhandledFrame$"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>unhandledFrame$</b></span>
                        <a href="#unhandledFrame$"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../interfaces/IFrame.html" target="_self" >Subject&lt;IFrame&gt;</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="107" class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:107</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>This function will be called for any unhandled frame.
Normally you should receive anything here unless it is non compliant STOMP broker
or an error.</p>
<p>This Observer will yield the received
<a href="../interfaces/IFrame.html">IFrame</a>
objects.</p>
<p>Maps to: <a href="../classes/Client.html#onUnhandledFrame">Client#onUnhandledFrame</a></p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="unhandledMessage$"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>unhandledMessage$</b></span>
                        <a href="#unhandledMessage$"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../interfaces/IMessage.html" target="_self" >Subject&lt;IMessage&gt;</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="94" class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:94</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>This function will be called for any unhandled messages.
It is useful for receiving messages sent to RabbitMQ temporary queues.</p>
<p>It can also get invoked with stray messages while the server is processing
a request to unsubscribe from an endpoint.</p>
<p>This Observer will yield the received
<a href="../interfaces/IMessage.html">IMessage</a>
objects.</p>
<p>Maps to: <a href="../classes/Client.html#onUnhandledMessage">Client#onUnhandledMessage</a></p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="unhandledReceipts$"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>unhandledReceipts$</b></span>
                        <a href="#unhandledReceipts$"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../interfaces/IFrame.html" target="_self" >Subject&lt;IFrame&gt;</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="119" class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:119</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>STOMP brokers can be requested to notify when an operation is actually completed.
Prefer using <a href="../classes/RxStomp.html#watchForReceipt">RxStomp#watchForReceipt</a>.</p>
<p>This Observer will yield the received
<a href="../interfaces/IFrame.html">IFrame</a>
objects.</p>
<p>Maps to: <a href="../classes/Client.html#onUnhandledReceipt">Client#onUnhandledReceipt</a></p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="webSocketErrors$"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>webSocketErrors$</b></span>
                        <a href="#webSocketErrors$"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>Subject&lt;Event&gt;</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="142" class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:142</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>It will stream all web socket errors.</p>
<p>This Observer will yield the received
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Event">Event</a>.</p>
<p>Maps to: <a href="../classes/Client.html#onWebSocketError">Client#onWebSocketError</a></p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="activate"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>activate</b></span>
                        <a href="#activate"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>activate()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="300"
                            class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:300</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Initiate the connection with the broker.
If the connection breaks, as per <a href="../classes/RxStompConfig.html#reconnectDelay">RxStompConfig#reconnectDelay</a>,
it will keep trying to reconnect.</p>
<p>Call <a href="../classes/RxStomp.html#deactivate">RxStomp#deactivate</a> to disconnect and stop reconnection attempts.</p>
<p>Maps to: <a href="../classes/Client.html#activate">Client#activate</a></p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="configure"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>configure</b></span>
                        <a href="#configure"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>configure(rxStompConfig: <a href="../classess/RxStompConfig.html" target="_self">RxStompConfig</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="268"
                            class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:268</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Set configuration. This method may be called multiple times.
Each call will add to the existing configuration.</p>
<p>Example:</p>
<div><pre class="line-numbers"><code class="language-javascript">       const rxStomp = new RxStomp();
       rxStomp.configure({
         brokerURL: &#39;ws://127.0.0.1:15674/ws&#39;,
         connectHeaders: {
           login: &#39;guest&#39;,
           passcode: &#39;guest&#39;
         },
         heartbeatIncoming: 0,
         heartbeatOutgoing: 20000,
         reconnectDelay: 200,
         debug: (msg: string): void =&gt; {
           console.log(new Date(), msg);
         }
       });
       rxStomp.activate();</code></pre></div><p>Maps to: <a href="../classes/Client.html#configure">Client#configure</a></p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>rxStompConfig</td>
                                    <td>
                                                <code><a href="../classess/RxStompConfig.html" target="_self" >RxStompConfig</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="connected"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>connected</b></span>
                        <a href="#connected"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>connected()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="360"
                            class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:360</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>It will return <code>true</code> if STOMP broker is connected and <code>false</code> otherwise.</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="deactivate"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span class="modifier">Async</span>
                        <span ><b>deactivate</b></span>
                        <a href="#deactivate"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>deactivate()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="347"
                            class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:347</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Disconnect if connected and stop auto reconnect loop.
Appropriate callbacks will be invoked if underlying STOMP connection was connected.</p>
<p>To reactivate you can call <a href="../classes/RxStomp.html#activate">RxStomp#activate</a>.</p>
<p>Maps to: <a href="../classes/Client.html#deactivate">Client#deactivate</a></p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="publish"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>publish</b></span>
                        <a href="#publish"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>publish(parameters: <a href="../interfaces/IRxStompPublishParams.html" target="_self">IRxStompPublishParams</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="420"
                            class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:420</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Send a message to a named destination. Refer to your STOMP broker documentation for types
and naming of destinations.</p>
<p>STOMP protocol specifies and suggests some headers and also allows broker specific headers.</p>
<p><code>body</code> must be String.
You will need to covert the payload to string in case it is not string (e.g. JSON).</p>
<p>To send a binary message body use binaryBody parameter. It should be a
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array">Uint8Array</a>.
Sometimes brokers may not support binary frames out of the box.
Please check your broker documentation.</p>
<p><code>content-length</code> header is automatically added to the STOMP Frame sent to the broker.
Set <code>skipContentLengthHeader</code> to indicate that <code>content-length</code> header should not be added.
For binary messages <code>content-length</code> header is always added.</p>
<p>Caution: The broker will, most likely, report an error and disconnect if message body has NULL octet(s)
and <code>content-length</code> header is missing.</p>
<p>The message will get locally queued if the STOMP broker is not connected. It will attempt to
publish queued messages as soon as the broker gets connected.
If you do not want that behavior,
please set <a href="../interfaces/IRxStompPublishParams.html#retryIfDisconnected">retryIfDisconnected</a> to <code>false</code>
in the parameters.
When <code>false</code>, this function will raise an error if message could not be sent immediately.</p>
<p>Maps to: <a href="../classes/Client.html#publish">Client#publish</a></p>
<p>See: <a href="../interfaces/IRxStompPublishParams.html">IRxStompPublishParams</a> and <a href="../interfaces/IPublishParams.html">IPublishParams</a></p>
<div><pre class="line-numbers"><code class="language-javascript">       rxStomp.publish({destination: &quot;/queue/test&quot;, headers: {priority: 9}, body: &quot;Hello, STOMP&quot;});

       // Only destination is mandatory parameter
       rxStomp.publish({destination: &quot;/queue/test&quot;, body: &quot;Hello, STOMP&quot;});

       // Skip content-length header in the frame to the broker
       rxStomp.publish({&quot;/queue/test&quot;, body: &quot;Hello, STOMP&quot;, skipContentLengthHeader: true});

       var binaryData = generateBinaryData(); // This need to be of type Uint8Array
       // setting content-type header is not mandatory, however a good practice
       rxStomp.publish({destination: &#39;/topic/special&#39;, binaryBody: binaryData,
                        headers: {&#39;content-type&#39;: &#39;application/octet-stream&#39;}});</code></pre></div></div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>parameters</td>
                                    <td>
                                                <code><a href="../interfaces/IRxStompPublishParams.html" target="_self" >IRxStompPublishParams</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="watch"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>watch</b></span>
                        <a href="#watch"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>watch(opts: <a href="../interfaces/IWatchParams.html" target="_self">IWatchParams</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="473"
                            class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:473</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>It will subscribe to server message queues</p>
<p>This method can be safely called even if the STOMP broker is not connected.
If the underlying STOMP connection drops and reconnects, by default, it will resubscribe automatically.
See <a href="../interfaces/IWatchParams.html#subscribeOnlyOnce">IWatchParams#subscribeOnlyOnce</a> also.</p>
<p>Note that messages might be missed during reconnect. This issue is not specific
to this library but the way STOMP brokers are designed to work.</p>
<p>This method in the underlying library is called <code>subscribe</code>.
In earlier version it was called <code>subscribe</code> here as well.
However <code>subscribe</code> is also used by RxJS and code reads strange with two subscribe calls
following each other and both meaning very different things.</p>
<p>This method has two alternate syntax, use <a href="../interfaces/IWatchParams.html">IWatchParams</a> if you need to pass additional options.</p>
<p>Maps to: <a href="../classes/Client.html#subscribe">Client#subscribe</a></p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>opts</td>
                                    <td>
                                                <code><a href="../interfaces/IWatchParams.html" target="_self" >IWatchParams</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../interfaces/IMessage.html" target="_self" >Observable&lt;IMessage&gt;</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="watch"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>watch</b></span>
                        <a href="#watch"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>watch(destination: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, headers?: <a href="../classes/StompHeaders.html" target="_self">StompHeaders</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="480"
                            class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:480</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>See the <a href="#watch">other variant</a> for details.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>destination</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                    </td>
                                </tr>
                                <tr>
                                    <td>headers</td>
                                    <td>
                                                <code><a href="../classes/StompHeaders.html" target="_self" >StompHeaders</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                    <td>
                                        <p>subscription headers</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../interfaces/IMessage.html" target="_self" >Observable&lt;IMessage&gt;</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="watch"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>watch</b></span>
                        <a href="#watch"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>watch(opts: <a href="../interfaces/IWatchParams.html" target="_self">string | IWatchParams</a>, headers: <a href="../classes/StompHeaders.html" target="_self">StompHeaders</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="484"
                            class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:484</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Default value</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>opts</td>
                                    <td>
                                                <code><a href="../interfaces/IWatchParams.html" target="_self" >string | IWatchParams</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                    </td>

                                </tr>
                                <tr>
                                    <td>headers</td>
                                    <td>
                                                <code><a href="../classes/StompHeaders.html" target="_self" >StompHeaders</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>

                                    <td>
                                        <code>{}</code>
                                    </td>

                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../interfaces/IMessage.html" target="_self" >Observable&lt;IMessage&gt;</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="watchForReceipt"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span ><b>watchForReceipt</b></span>
                        <a href="#watchForReceipt"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>watchForReceipt(receiptId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, callback: (frame: <a href="../interfaces/IFrame.html">IFrame</a>) => void)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="616"
                            class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:616</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>STOMP brokers may carry out operation asynchronously and allow requesting for acknowledgement.
To request an acknowledgement, a <code>receipt</code> header needs to be sent with the actual request.
The value (say receipt-id) for this header needs to be unique for each use. Typically a sequence, a UUID, a
random number or a combination may be used.</p>
<p>A complaint broker will send a RECEIPT frame when an operation has actually been completed.
The operation needs to be matched based in the value of the receipt-id.</p>
<p>This method allow watching for a receipt and invoke the callback
when corresponding receipt has been received.</p>
<p>The actual <a href="../miscellaneous/typealiases.html#Frame">Frame</a>
will be passed as parameter to the callback.</p>
<p>Example:</p>
<div><pre class="line-numbers"><code class="language-javascript">       // Publishing with acknowledgement
       let receiptId = randomText();

       rxStomp.watchForReceipt(receiptId, function() {
         // Will be called after server acknowledges
       });
       rxStomp.publish({destination: &#39;/topic/special&#39;, headers: {receipt: receiptId}, body: msg});</code></pre></div><p>Maps to: <a href="../classes/Client.html#watchForReceipt">Client#watchForReceipt</a></p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>receiptId</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>callback</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank" >function</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>





            <section>
    <h3 id="accessors">
        Accessors
    </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="stompClient"></a>
                        <span class="name"><b>stompClient</b><a href="#stompClient"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>stompClient()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="156" class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:156</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Instance of actual
<a href="https://github.com/stomp-js/stompjs">@stomp/stompjs</a>
<a href="../classes/Client.html">Client</a>.</p>
<p><strong>Be careful in calling methods on it directly - you may get unintended consequences.</strong></p>
</div>

                                <div class="io-description">
                                    <b>Returns : </b>        <code><a href="../classess/Client.html" target="_self" >Client</a></code>

                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="active"></a>
                        <span class="name"><b>active</b><a href="#active"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>active()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="369" class="link-to-prism">consolidated/rx-stomp/src/rx-stomp.ts:369</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>If the client is active (connected or going to reconnect).</p>
<p> Maps to: <a href="../classes/Client.html#active">Client#active</a></p>
</div>

                                <div class="io-description">
                                    <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
</section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import {
  BehaviorSubject,
  filter,
  Observable,
  Observer,
  share,
  Subject,
  Subscription,
  take,
} from &#x27;rxjs&#x27;;

import {
  Client,
  debugFnType,
  IFrame,
  IMessage,
  publishParams,
  StompConfig,
  StompHeaders,
  StompSubscription,
} from &#x27;@stomp/stompjs&#x27;;

import { RxStompConfig } from &#x27;./rx-stomp-config.js&#x27;;
import { IRxStompPublishParams } from &#x27;./i-rx-stomp-publish-params.js&#x27;;
import { RxStompState } from &#x27;./rx-stomp-state.js&#x27;;
import { IWatchParams } from &#x27;./i-watch-params.js&#x27;;

/**
 * This is the main Stomp Client.
 * Typically you will create an instance of this to connect to the STOMP broker.
 *
 * This wraps [@stomp/stompjs]{@link https://github.com/stomp-js/stompjs}
 * {@link Client} class.
 *
 * The key difference is that it exposes operations as RxJS Observables.
 * For example when a STOMP endpoint is subscribed it returns an Observable
 * that will stream all received messages.
 *
 * With exception of beforeConnect, functionality related to all callbacks in
 * [@stomp/stompjs Client]{@link Client}
 * is exposed as Observables/Subjects/BehaviorSubjects.
 *
 * RxStomp also tries to transparently handle connection failures.
 *
 * Part of &#x60;@stomp/rx-stomp&#x60;
 */
export class RxStomp {
  /**
   * Connection State
   *
   * It is a BehaviorSubject and will emit current status immediately. This will typically get
   * used to show current status to the end user.
   */
  public readonly connectionState$: BehaviorSubject&lt;RxStompState&gt;;

  /**
   * Will trigger when connection is established.
   * It will trigger every time a (re)connection occurs.
   * If it is already connected it will trigger immediately.
   * You can safely ignore the value, as it will always be &#x60;StompState.OPEN&#x60;
   */
  public readonly connected$: Observable&lt;RxStompState&gt;;

  /**
   * These will be triggered before connectionState$ and connected$.
   * During a reconnect, tt will allow subscriptions to be reinstated before sending
   * queued messages.
   */
  private _connectionStatePre$: BehaviorSubject&lt;RxStompState&gt;;
  private _connectedPre$: Observable&lt;RxStompState&gt;;

  /**
   * Provides headers from most recent connection to the server as returned by the CONNECTED frame.
   * If the STOMP connection has already been established it will trigger immediately.
   * It will trigger for each reconnection.
   */
  public readonly serverHeaders$: Observable&lt;StompHeaders&gt;;

  protected _serverHeadersBehaviourSubject$: BehaviorSubject&lt;null | StompHeaders&gt;;

  /**
   * This function will be called for any unhandled messages.
   * It is useful for receiving messages sent to RabbitMQ temporary queues.
   *
   * It can also get invoked with stray messages while the server is processing
   * a request to unsubscribe from an endpoint.
   *
   * This Observer will yield the received
   * {@link IMessage}
   * objects.
   *
   * Maps to: [Client#onUnhandledMessage]{@link Client#onUnhandledMessage}
   */
  public readonly unhandledMessage$: Subject&lt;IMessage&gt;;

  /**
   * This function will be called for any unhandled frame.
   * Normally you should receive anything here unless it is non compliant STOMP broker
   * or an error.
   *
   * This Observer will yield the received
   * {@link IFrame}
   * objects.
   *
   * Maps to: [Client#onUnhandledFrame]{@link Client#onUnhandledFrame}
   */
  public readonly unhandledFrame$: Subject&lt;IFrame&gt;;

  /**
   * STOMP brokers can be requested to notify when an operation is actually completed.
   * Prefer using [RxStomp#watchForReceipt]{@link RxStomp#watchForReceipt}.
   *
   * This Observer will yield the received
   * {@link IFrame}
   * objects.
   *
   * Maps to: [Client#onUnhandledReceipt]{@link Client#onUnhandledReceipt}
   */
  public readonly unhandledReceipts$: Subject&lt;IFrame&gt;;

  /**
   * It will stream all ERROR frames received from the STOMP Broker.
   * A compliant STOMP Broker will close the connection after this type of frame.
   * Please check broker specific documentation for exact behavior.
   *
   * This Observer will yield the received
   * {@link IFrame}
   * objects.
   *
   * Maps to: [Client#onStompError]{@link Client#onStompError}
   */
  public readonly stompErrors$: Subject&lt;IFrame&gt;;

  /**
   * It will stream all web socket errors.
   *
   * This Observer will yield the received
   * [Event]{@link https://developer.mozilla.org/en-US/docs/Web/API/Event}.
   *
   * Maps to: [Client#onWebSocketError]{@link Client#onWebSocketError}
   */
  public readonly webSocketErrors$: Subject&lt;Event&gt;;

  /**
   * Internal array to hold locally queued messages when STOMP broker is not connected.
   */
  protected _queuedMessages: publishParams[] &#x3D; [];

  /**
   * Instance of actual
   * [@stomp/stompjs]{@link https://github.com/stomp-js/stompjs}
   * {@link Client}.
   *
   * **Be careful in calling methods on it directly - you may get unintended consequences.**
   */
  get stompClient(): Client {
    return this._stompClient;
  }
  protected _stompClient: Client;

  /**
   * Before connect
   */
  protected _beforeConnect: (client: RxStomp) &#x3D;&gt; void | Promise&lt;void&gt;;

  /**
   * Correlate errors
   */
  protected _correlateErrors: (error: IFrame) &#x3D;&gt; string;

  /**
   * Will be assigned during configuration, no-op otherwise
   */
  protected _debug: debugFnType;

  /**
   * Constructor
   *
   * @param stompClient optionally inject the
   * [@stomp/stompjs]{@link https://github.com/stomp-js/stompjs}
   * {@link Client} to wrap. If this is not provided, a client will
   * be constructed internally.
   */
  public constructor(stompClient?: Client) {
    const client &#x3D; stompClient ? stompClient : new Client();
    this._stompClient &#x3D; client;

    const noOp &#x3D; () &#x3D;&gt; {};

    // Before connect is no op by default
    this._beforeConnect &#x3D; noOp;

    // Correlate errors is falsey op by default
    this._correlateErrors &#x3D; () &#x3D;&gt; undefined;

    // debug is no-op by default
    this._debug &#x3D; noOp;

    // Initial state is CLOSED
    this._connectionStatePre$ &#x3D; new BehaviorSubject&lt;RxStompState&gt;(
      RxStompState.CLOSED
    );

    this._connectedPre$ &#x3D; this._connectionStatePre$.pipe(
      filter((currentState: RxStompState) &#x3D;&gt; {
        return currentState &#x3D;&#x3D;&#x3D; RxStompState.OPEN;
      })
    );

    // Initial state is CLOSED
    this.connectionState$ &#x3D; new BehaviorSubject&lt;RxStompState&gt;(
      RxStompState.CLOSED
    );

    this.connected$ &#x3D; this.connectionState$.pipe(
      filter((currentState: RxStompState) &#x3D;&gt; {
        return currentState &#x3D;&#x3D;&#x3D; RxStompState.OPEN;
      })
    );

    // Setup sending queuedMessages
    this.connected$.subscribe(() &#x3D;&gt; {
      this._sendQueuedMessages();
    });

    this._serverHeadersBehaviourSubject$ &#x3D;
      new BehaviorSubject&lt;null | StompHeaders&gt;(null);

    this.serverHeaders$ &#x3D; this._serverHeadersBehaviourSubject$.pipe(
      filter((headers: null | StompHeaders) &#x3D;&gt; {
        return headers !&#x3D;&#x3D; null;
      })
    );

    this.stompErrors$ &#x3D; new Subject&lt;IFrame&gt;();
    this.unhandledMessage$ &#x3D; new Subject&lt;IMessage&gt;();
    this.unhandledReceipts$ &#x3D; new Subject&lt;IFrame&gt;();
    this.unhandledFrame$ &#x3D; new Subject&lt;IFrame&gt;();
    this.webSocketErrors$ &#x3D; new Subject&lt;Event&gt;();
  }

  /**
   * Set configuration. This method may be called multiple times.
   * Each call will add to the existing configuration.
   *
   * Example:
   *
   * &#x60;&#x60;&#x60;javascript
   *        const rxStomp &#x3D; new RxStomp();
   *        rxStomp.configure({
   *          brokerURL: &#x27;ws://127.0.0.1:15674/ws&#x27;,
   *          connectHeaders: {
   *            login: &#x27;guest&#x27;,
   *            passcode: &#x27;guest&#x27;
   *          },
   *          heartbeatIncoming: 0,
   *          heartbeatOutgoing: 20000,
   *          reconnectDelay: 200,
   *          debug: (msg: string): void &#x3D;&gt; {
   *            console.log(new Date(), msg);
   *          }
   *        });
   *        rxStomp.activate();
   * &#x60;&#x60;&#x60;
   *
   * Maps to: [Client#configure]{@link Client#configure}
   */
  public configure(rxStompConfig: RxStompConfig) {
    const stompConfig: RxStompConfig &#x3D; (Object as any).assign(
      {},
      rxStompConfig
    );

    if (stompConfig.beforeConnect) {
      this._beforeConnect &#x3D; stompConfig.beforeConnect;
      delete stompConfig.beforeConnect;
    }

    if (stompConfig.correlateErrors) {
      this._correlateErrors &#x3D; stompConfig.correlateErrors;
      delete stompConfig.correlateErrors;
    }

    // RxStompConfig has subset of StompConfig fields
    this._stompClient.configure(stompConfig as StompConfig);
    if (stompConfig.debug) {
      this._debug &#x3D; stompConfig.debug;
    }
  }

  /**
   * Initiate the connection with the broker.
   * If the connection breaks, as per [RxStompConfig#reconnectDelay]{@link RxStompConfig#reconnectDelay},
   * it will keep trying to reconnect.
   *
   * Call [RxStomp#deactivate]{@link RxStomp#deactivate} to disconnect and stop reconnection attempts.
   *
   * Maps to: [Client#activate]{@link Client#activate}
   */
  public activate(): void {
    this._stompClient.configure({
      beforeConnect: async () &#x3D;&gt; {
        this._changeState(RxStompState.CONNECTING);

        // Call handler
        await this._beforeConnect(this);
      },
      onConnect: (frame: IFrame) &#x3D;&gt; {
        this._serverHeadersBehaviourSubject$.next(frame.headers);

        // Indicate our connected state to observers
        this._changeState(RxStompState.OPEN);
      },
      onStompError: (frame: IFrame) &#x3D;&gt; {
        // Trigger the frame subject
        this.stompErrors$.next(frame);
      },
      onWebSocketClose: () &#x3D;&gt; {
        this._changeState(RxStompState.CLOSED);
      },
      onUnhandledMessage: (message: IMessage) &#x3D;&gt; {
        this.unhandledMessage$.next(message);
      },
      onUnhandledReceipt: (frame: IFrame) &#x3D;&gt; {
        this.unhandledReceipts$.next(frame);
      },
      onUnhandledFrame: (frame: IFrame) &#x3D;&gt; {
        this.unhandledFrame$.next(frame);
      },
      onWebSocketError: (evt: Event) &#x3D;&gt; {
        this.webSocketErrors$.next(evt);
      },
    });

    // Attempt connection
    this._stompClient.activate();
  }

  /**
   * Disconnect if connected and stop auto reconnect loop.
   * Appropriate callbacks will be invoked if underlying STOMP connection was connected.
   *
   * To reactivate you can call [RxStomp#activate]{@link RxStomp#activate}.
   *
   * Maps to: [Client#deactivate]{@link Client#deactivate}
   */
  public async deactivate(): Promise&lt;void&gt; {
    this._changeState(RxStompState.CLOSING);

    // The promise will be resolved immediately if there are no active connection
    // otherwise, after it has successfully disconnected.
    await this._stompClient.deactivate();

    this._changeState(RxStompState.CLOSED);
  }

  /**
   * It will return &#x60;true&#x60; if STOMP broker is connected and &#x60;false&#x60; otherwise.
   */
  public connected(): boolean {
    return this.connectionState$.getValue() &#x3D;&#x3D;&#x3D; RxStompState.OPEN;
  }

  /**
   * If the client is active (connected or going to reconnect).
   *
   *  Maps to: [Client#active]{@link Client#active}
   */
  get active(): boolean {
    return this.stompClient.active;
  }

  /**
   * Send a message to a named destination. Refer to your STOMP broker documentation for types
   * and naming of destinations.
   *
   * STOMP protocol specifies and suggests some headers and also allows broker specific headers.
   *
   * &#x60;body&#x60; must be String.
   * You will need to covert the payload to string in case it is not string (e.g. JSON).
   *
   * To send a binary message body use binaryBody parameter. It should be a
   * [Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array).
   * Sometimes brokers may not support binary frames out of the box.
   * Please check your broker documentation.
   *
   * &#x60;content-length&#x60; header is automatically added to the STOMP Frame sent to the broker.
   * Set &#x60;skipContentLengthHeader&#x60; to indicate that &#x60;content-length&#x60; header should not be added.
   * For binary messages &#x60;content-length&#x60; header is always added.
   *
   * Caution: The broker will, most likely, report an error and disconnect if message body has NULL octet(s)
   * and &#x60;content-length&#x60; header is missing.
   *
   * The message will get locally queued if the STOMP broker is not connected. It will attempt to
   * publish queued messages as soon as the broker gets connected.
   * If you do not want that behavior,
   * please set [retryIfDisconnected]{@link IRxStompPublishParams#retryIfDisconnected} to &#x60;false&#x60;
   * in the parameters.
   * When &#x60;false&#x60;, this function will raise an error if message could not be sent immediately.
   *
   * Maps to: [Client#publish]{@link Client#publish}
   *
   * See: {@link IRxStompPublishParams} and {@link IPublishParams}
   *
   * &#x60;&#x60;&#x60;javascript
   *        rxStomp.publish({destination: &quot;/queue/test&quot;, headers: {priority: 9}, body: &quot;Hello, STOMP&quot;});
   *
   *        // Only destination is mandatory parameter
   *        rxStomp.publish({destination: &quot;/queue/test&quot;, body: &quot;Hello, STOMP&quot;});
   *
   *        // Skip content-length header in the frame to the broker
   *        rxStomp.publish({&quot;/queue/test&quot;, body: &quot;Hello, STOMP&quot;, skipContentLengthHeader: true});
   *
   *        var binaryData &#x3D; generateBinaryData(); // This need to be of type Uint8Array
   *        // setting content-type header is not mandatory, however a good practice
   *        rxStomp.publish({destination: &#x27;/topic/special&#x27;, binaryBody: binaryData,
   *                         headers: {&#x27;content-type&#x27;: &#x27;application/octet-stream&#x27;}});
   * &#x60;&#x60;&#x60;
   */
  public publish(parameters: IRxStompPublishParams): void {
    // retry behaviour is defaulted to true
    const shouldRetry &#x3D;
      parameters.retryIfDisconnected &#x3D;&#x3D; null
        ? true
        : parameters.retryIfDisconnected;

    if (this.connected()) {
      this._stompClient.publish(parameters);
    } else if (shouldRetry) {
      this._debug(&#x60;Not connected, queueing&#x60;);
      this._queuedMessages.push(parameters);
    } else {
      throw new Error(&#x27;Cannot publish while broker is not connected&#x27;);
    }
  }

  /** It will send queued messages. */
  protected _sendQueuedMessages(): void {
    const queuedMessages &#x3D; this._queuedMessages;
    this._queuedMessages &#x3D; [];

    if (queuedMessages.length &#x3D;&#x3D;&#x3D; 0) {
      return;
    }

    this._debug(&#x60;Will try sending  ${queuedMessages.length} queued message(s)&#x60;);

    for (const queuedMessage of queuedMessages) {
      this._debug(&#x60;Attempting to send ${queuedMessage}&#x60;);
      this.publish(queuedMessage);
    }
  }

  /**
   * It will subscribe to server message queues
   *
   * This method can be safely called even if the STOMP broker is not connected.
   * If the underlying STOMP connection drops and reconnects, by default, it will resubscribe automatically.
   * See [IWatchParams#subscribeOnlyOnce]{@link IWatchParams#subscribeOnlyOnce} also.
   *
   * Note that messages might be missed during reconnect. This issue is not specific
   * to this library but the way STOMP brokers are designed to work.
   *
   * This method in the underlying library is called &#x60;subscribe&#x60;.
   * In earlier version it was called &#x60;subscribe&#x60; here as well.
   * However &#x60;subscribe&#x60; is also used by RxJS and code reads strange with two subscribe calls
   * following each other and both meaning very different things.
   *
   * This method has two alternate syntax, use [IWatchParams]{@link IWatchParams} if you need to pass additional options.
   *
   * Maps to: [Client#subscribe]{@link Client#subscribe}
   */
  public watch(opts: IWatchParams): Observable&lt;IMessage&gt;;
  /**
   * See the [other variant]{@link #watch} for details.
   *
   * @param destination
   * @param headers subscription headers
   */
  public watch(
    destination: string,
    headers?: StompHeaders
  ): Observable&lt;IMessage&gt;;
  public watch(
    opts: string | IWatchParams,
    headers: StompHeaders &#x3D; {}
  ): Observable&lt;IMessage&gt; {
    const defaults: IWatchParams &#x3D; {
      subHeaders: {},
      unsubHeaders: {},
      subscribeOnlyOnce: false,
    };

    let params: IWatchParams;

    if (typeof opts &#x3D;&#x3D;&#x3D; &#x27;string&#x27;) {
      params &#x3D; Object.assign({}, defaults, {
        destination: opts,
        subHeaders: headers,
      });
    } else {
      params &#x3D; Object.assign({}, defaults, opts);
    }

    /* Well the logic is complicated but works beautifully. RxJS is indeed wonderful.
     *
     * We need to activate the underlying subscription immediately if Stomp is connected. If not it should
     * subscribe when it gets next connected. Further it should re establish the subscription whenever Stomp
     * successfully reconnects.
     *
     * Actual implementation is simple, we filter the BehaviourSubject &#x27;state&#x27; so that we can trigger whenever Stomp is
     * connected. Since &#x27;state&#x27; is a BehaviourSubject, if Stomp is already connected, it will immediately trigger.
     *
     * The observable that we return to caller remains same across all reconnects, so no special handling needed at
     * the message subscriber.
     */
    this._debug(&#x60;Request to subscribe ${params.destination}&#x60;);

    const coldObservable &#x3D; Observable.create((messages: Observer&lt;IMessage&gt;) &#x3D;&gt; {
      /*
       * These variables will be used as part of the closure and work their magic during unsubscribe
       */
      let stompSubscription: StompSubscription; // Stomp

      let stompConnectedSubscription: Subscription; // RxJS

      let connectedPre$ &#x3D; this._connectedPre$;

      if (params.subscribeOnlyOnce) {
        connectedPre$ &#x3D; connectedPre$.pipe(take(1));
      }

      const stompErrorsSubscription &#x3D; this.stompErrors$.subscribe(
        (error: IFrame) &#x3D;&gt; {
          const correlatedDestination &#x3D; this._correlateErrors(error);
          if (correlatedDestination &#x3D;&#x3D;&#x3D; params.destination) {
            messages.error(error);
          }
        }
      );

      stompConnectedSubscription &#x3D; connectedPre$.subscribe(() &#x3D;&gt; {
        this._debug(&#x60;Will subscribe to ${params.destination}&#x60;);
        let subHeaders &#x3D; params.subHeaders;
        if (typeof subHeaders &#x3D;&#x3D;&#x3D; &#x27;function&#x27;) {
          subHeaders &#x3D; subHeaders();
        }
        stompSubscription &#x3D; this._stompClient.subscribe(
          params.destination,
          (message: IMessage) &#x3D;&gt; {
            messages.next(message);
          },
          subHeaders
        );
      });

      return () &#x3D;&gt; {
        /* cleanup function, will be called when no subscribers are left */
        this._debug(
          &#x60;Stop watching connection state (for ${params.destination})&#x60;
        );
        stompConnectedSubscription.unsubscribe();
        stompErrorsSubscription.unsubscribe();

        if (this.connected()) {
          this._debug(&#x60;Will unsubscribe from ${params.destination} at Stomp&#x60;);
          let unsubHeaders &#x3D; params.unsubHeaders;
          if (typeof unsubHeaders &#x3D;&#x3D;&#x3D; &#x27;function&#x27;) {
            unsubHeaders &#x3D; unsubHeaders();
          }
          stompSubscription.unsubscribe(unsubHeaders);
        } else {
          this._debug(
            &#x60;Stomp not connected, no need to unsubscribe from ${params.destination} at Stomp&#x60;
          );
        }
      };
    });

    /**
     * Important - convert it to hot Observable - otherwise, if the user code subscribes
     * to this observable twice, it will subscribe twice to Stomp broker. (This was happening in the current example).
     * A long but good explanatory article at https://medium.com/@benlesh/hot-vs-cold-observables-f8094ed53339
     */
    return coldObservable.pipe(share());
  }

  /**
   * STOMP brokers may carry out operation asynchronously and allow requesting for acknowledgement.
   * To request an acknowledgement, a &#x60;receipt&#x60; header needs to be sent with the actual request.
   * The value (say receipt-id) for this header needs to be unique for each use. Typically a sequence, a UUID, a
   * random number or a combination may be used.
   *
   * A complaint broker will send a RECEIPT frame when an operation has actually been completed.
   * The operation needs to be matched based in the value of the receipt-id.
   *
   * This method allow watching for a receipt and invoke the callback
   * when corresponding receipt has been received.
   *
   * The actual {@link Frame}
   * will be passed as parameter to the callback.
   *
   * Example:
   * &#x60;&#x60;&#x60;javascript
   *        // Publishing with acknowledgement
   *        let receiptId &#x3D; randomText();
   *
   *        rxStomp.watchForReceipt(receiptId, function() {
   *          // Will be called after server acknowledges
   *        });
   *        rxStomp.publish({destination: &#x27;/topic/special&#x27;, headers: {receipt: receiptId}, body: msg});
   * &#x60;&#x60;&#x60;
   *
   * Maps to: [Client#watchForReceipt]{@link Client#watchForReceipt}
   */
  public watchForReceipt(
    receiptId: string,
    callback: (frame: IFrame) &#x3D;&gt; void
  ): void {
    this._stompClient.watchForReceipt(receiptId, callback);
  }

  protected _changeState(state: RxStompState): void {
    this._connectionStatePre$.next(state);
    this.connectionState$.next(state);
  }
}
</code></pre>
    </div>
</div>









                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'RxStomp.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
